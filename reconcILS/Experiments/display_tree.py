import os
import copy
from ete3 import PhyloTree  
from collections import Counter
import sys
sys.path.append("../")
from reconcILS import *
from utils import *
import pandas as pd 
import time
import re


newick_with_data ='(1078-1709-511   862-0-4464   AC,(131-1613-1492   104-0-5092   B,(133-1225-1752   120-0-7241   A,((86-81-501   72-0-6515   F,(187-4-171   143-0-5766   D,54-4-224   48-0-5786   E)0-92-325   4-0-6488   )0-1192-1131   133-0-5862   ,(98-54-1577   86-0-7534   C,(((73-5-542   75-0-7845   AB,76-9-480   70-0-7839   AA)0-3483-84   4-0-14606   ,(82-5-458   66-0-7833   G,82-6-480   67-0-7828   Z)0-1913-93   2-0-13429   )312-309-755   4082-0-7866   ,((((89-12-443   57-0-11423   P,47-17-438   35-0-11432   Q)1-1190-345   9-0-11433   ,(106-38-256   48-0-11831   R,57-38-195   23-0-11826   S)9-985-531   51-0-9753   )28-1520-967   1527-0-12010   ,(82-861-1886   65-0-10844   O,((58-1150-1079   34-0-11485   J,(162-146-634   71-0-17499   I,476-144-527   227-0-17267   M)17-1112-478   105-0-13199   )6-2625-1626   1598-0-18285   ,((64-11-1091   40-0-16513   H,66-10-1133   40-0-16584   N)0-2155-986   4-0-14200   ,(109-29-918   61-0-16847   L,80-15-889   45-0-16890   K)1-1357-1174   16-0-13314   )146-3047-777   1382-0-17975   )1076-2219-249   2385-0-9702   )609-2350-413   1398-0-12376   )1026-594-491   1871-0-7235   ,(70-975-750   59-0-10062   Y,(320-285-536   295-0-9334   X,(93-1046-458   76-0-11910   T,((77-39-222   31-0-11568   V,197-59-194   118-0-11534   W)8-478-152   54-0-9416   ,638-505-465   548-0-9823   U)17-1464-96   483-0-12147   )24-511-156   1744-0-8146   )50-1451-145   290-0-9875   )117-1318-625   1715-0-7679   )417-840-237   768-0-7654   )274-110-468   513-0-5255   )48-1419-479   27-0-6537   )125-2363-110   839-0-6277   )201-3765-39   853-0-5338   )753-2907-16   2005-0-5556   )630-0-0   5310-0-0   ;'



pattern = re.compile(r"(\d+-\d+-\d+)\s+(\d+-\d+-\d+)\s+(\w+)|(\w+)\s+(\d+-\d+-\d+)\s+(\d+-\d+-\d+)|(\d+-\d+-\d+)\s+(\d+-\d+-\d+)")

# Extracting matches
matches = pattern.findall(newick_with_data)

numeric_data = {}

clean_newick_pattern = re.compile(r"\d+-\d+-\d+\s+\d+-\d+-\d+\s+")

clean_newick = re.sub(clean_newick_pattern, '', newick_with_data)
clean_newick = clean_newick.replace(" , ", ",")
clean_newick = re.sub(r"\s+", " ", clean_newick) 


reco =reconcils()
red= readWrite.readWrite()
sp_large=red.parse_bio(clean_newick)

sp_large.label_internal()

print(red.to_newick(sp_large))